<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="SignUp-Patient.css" />
    <link rel="stylesheet" href="/Preheader/Preheader.css" />
    <link rel="stylesheet" href="/Main.css" />
    <script src="/ValidationAccs.js"></script>
    <script src="/Prefooter/Prefooter.js"></script>
  </head>

  <body>
    <header class="header">
      <div class="header-logo"><span>T</span>ADAWI</div>
      <nav class="nav">
        <a href="/Home/HomePage.html">Home</a>
        <a href="/About-us/About-usPre.html">About us</a>
        <a href="/HelpPage/Help.html">Help</a>
      </nav>
      <div class="dropdown">
        <button class="dropdown-button">Sign up <span class="arrow">&#9660;</span></button>
        <div class="dropdown-content">
          <a href="/Login-OTP/UserLogin.html">Login</a>
          <a href="/CreateAccount/CreateAccount.html">Sign up</a>
        </div>
      </div>
    </header>
    <!-- Patient sign up Form -->
    <div class="form-container">
      <a href="/CreateAccount/CreateAccount.html" class="back-link">&larr; Back</a>
      <h2>Patient Create Account</h2>

      <form id="patientForm">
        <label for="email">Email</label>
        <input
          type="email"
          id="email"
          name="email"
          required
          title="2 to 20 letters"
          placeholder="Please enter a valid email"
        />

        <label for="password"> Password</label>
        <input
          type="password"
          id="password"
          name="password"
          required
          title="2 to 20 letters"
          placeholder="Please use a strong password"
        />

        <label for="confirmPassword">Confirm Password</label>
        <input
          type="password"
          id="confirmPassword"
          name="confirmPassword"
          required
          title="2 to 20 letters"
          placeholder="Please re-enter your password"
        />

        <label for="name">Full Name</label>
        <input type="text" id="name" name="name" required placeholder="Enter your full name" />

        <label for="title">Title</label>
        <select id="title" name="title">
          <option value="" disabled selected>Select Title</option>
          <option value="Mr.">Mr.</option>
          <option value="Mrs.">Mrs.</option>
          <option value="Ms.">Ms.</option>
          <option value="Miss">Miss</option>
          <option value="Dr.">Dr.</option>
          <option value="Prof.">Prof.</option>
        </select>

        <label for="gender">Gender</label>
        <select id="gender" name="gender" required>
          <option value="" disabled selected>Select Your Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
        </select>

        <label for="phoneNumber">Phone Number</label>
        <input type="text" id="phoneNumber" name="phoneNumber" required placeholder="+966" />

        <label for="dateOfBirth">Date of Birth</label>
        <input type="date" id="dateOfBirth" name="dateOfBirth" required />

        <label for="nationality">Nationality</label>
        <select id="nationality" name="nationality">
          <option value="" disabled selected>Select Your Nationality</option>
        
          <optgroup label="A">
            <option value="Afghan">Afghan</option>
            <option value="Albanian">Albanian</option>
            <option value="Algerian">Algerian</option>
            <option value="American">American</option>
            <option value="Andorran">Andorran</option>
            <option value="Angolan">Angolan</option>
            <option value="Anguillan">Anguillan</option>
            <option value="Citizen of Antigua and Barbuda">Citizen of Antigua and Barbuda</option>
            <option value="Argentine">Argentine</option>
            <option value="Armenian">Armenian</option>
            <option value="Australian">Australian</option>
            <option value="Austrian">Austrian</option>
            <option value="Azerbaijani">Azerbaijani</option>
          </optgroup>
        
          <optgroup label="B">
            <option value="Bahamian">Bahamian</option>
            <option value="Bahraini">Bahraini</option>
            <option value="Bangladeshi">Bangladeshi</option>
            <option value="Barbadian">Barbadian</option>
            <option value="Belarusian">Belarusian</option>
            <option value="Belgian">Belgian</option>
            <option value="Belizean">Belizean</option>
            <option value="Beninese">Beninese</option>
            <option value="Bermudian">Bermudian</option>
            <option value="Bhutanese">Bhutanese</option>
            <option value="Bolivian">Bolivian</option>
            <option value="Citizen of Bosnia and Herzegovina">Citizen of Bosnia and Herzegovina</option>
            <option value="Botswanan">Botswanan</option>
            <option value="Brazilian">Brazilian</option>
            <option value="British">British</option>
            <option value="British Virgin Islander">British Virgin Islander</option>
            <option value="Bruneian">Bruneian</option>
            <option value="Bulgarian">Bulgarian</option>
            <option value="Burkinan">Burkinan</option>
            <option value="Burmese">Burmese</option>
            <option value="Burundian">Burundian</option>
          </optgroup>
          <optgroup label="C">
            <option value="Cambodian">Cambodian</option>
            <option value="Cameroonian">Cameroonian</option>
            <option value="Canadian">Canadian</option>
            <option value="Cape Verdean">Cape Verdean</option>
            <option value="Cayman Islander">Cayman Islander</option>
            <option value="Central African">Central African</option>
            <option value="Chadian">Chadian</option>
            <option value="Chilean">Chilean</option>
            <option value="Chinese">Chinese</option>
            <option value="Colombian">Colombian</option>
            <option value="Comoran">Comoran</option>
            <option value="Congolese (Congo)">Congolese (Congo)</option>
            <option value="Congolese (DRC)">Congolese (DRC)</option>
            <option value="Cook Islander">Cook Islander</option>
            <option value="Costa Rican">Costa Rican</option>
            <option value="Croatian">Croatian</option>
            <option value="Cuban">Cuban</option>
            <option value="Cymraes">Cymraes</option>
            <option value="Cymro">Cymro</option>
            <option value="Cypriot">Cypriot</option>
            <option value="Czech">Czech</option>
          </optgroup>
        
          <optgroup label="D">
            <option value="Danish">Danish</option>
            <option value="Djiboutian">Djiboutian</option>
            <option value="Dominican">Dominican</option>
            <option value="Citizen of the Dominican Republic">Citizen of the Dominican Republic</option>
            <option value="Dutch">Dutch</option>
          </optgroup>
          <optgroup label="E">
            <option value="East Timorese">East Timorese</option>
            <option value="Ecuadorean">Ecuadorean</option>
            <option value="Egyptian">Egyptian</option>
            <option value="Emirati">Emirati</option>
            <option value="English">English</option>
            <option value="Equatorial Guinean">Equatorial Guinean</option>
            <option value="Eritrean">Eritrean</option>
            <option value="Estonian">Estonian</option>
            <option value="Ethiopian">Ethiopian</option>
          </optgroup>
        
          <optgroup label="F">
            <option value="Faroese">Faroese</option>
            <option value="Fijian">Fijian</option>
            <option value="Filipino">Filipino</option>
            <option value="Finnish">Finnish</option>
            <option value="French">French</option>
          </optgroup>
        
          <optgroup label="G">
            <option value="Gabonese">Gabonese</option>
            <option value="Gambian">Gambian</option>
            <option value="Georgian">Georgian</option>
            <option value="German">German</option>
            <option value="Ghanaian">Ghanaian</option>
            <option value="Gibraltarian">Gibraltarian</option>
            <option value="Greek">Greek</option>
            <option value="Greenlandic">Greenlandic</option>
            <option value="Grenadian">Grenadian</option>
            <option value="Guamanian">Guamanian</option>
            <option value="Guatemalan">Guatemalan</option>
            <option value="Citizen of Guinea-Bissau">Citizen of Guinea-Bissau</option>
            <option value="Guinean">Guinean</option>
            <option value="Guyanese">Guyanese</option>
          </optgroup>
          <optgroup label="H">
            <option value="Haitian">Haitian</option>
            <option value="Honduran">Honduran</option>
            <option value="Hong Konger">Hong Konger</option>
            <option value="Hungarian">Hungarian</option>
          </optgroup>
        
          <optgroup label="I">
            <option value="Icelandic">Icelandic</option>
            <option value="Indian">Indian</option>
            <option value="Indonesian">Indonesian</option>
            <option value="Iranian">Iranian</option>
            <option value="Iraqi">Iraqi</option>
            <option value="Irish">Irish</option>
            <option value="Italian">Italian</option>
            <option value="Ivorian">Ivorian</option>
          </optgroup>
        
          <optgroup label="J">
            <option value="Jamaican">Jamaican</option>
            <option value="Japanese">Japanese</option>
            <option value="Jordanian">Jordanian</option>
          </optgroup>
        
          <optgroup label="K">
            <option value="Kazakh">Kazakh</option>
            <option value="Kenyan">Kenyan</option>
            <option value="Kittitian">Kittitian</option>
            <option value="Citizen of Kiribati">Citizen of Kiribati</option>
            <option value="Kosovan">Kosovan</option>
            <option value="Kuwaiti">Kuwaiti</option>
            <option value="Kyrgyz">Kyrgyz</option>
          </optgroup>
          <optgroup label="L">
            <option value="Lao">Lao</option>
            <option value="Latvian">Latvian</option>
            <option value="Lebanese">Lebanese</option>
            <option value="Liberian">Liberian</option>
            <option value="Libyan">Libyan</option>
            <option value="Liechtenstein citizen">Liechtenstein citizen</option>
            <option value="Lithuanian">Lithuanian</option>
            <option value="Luxembourger">Luxembourger</option>
          </optgroup>
        
          <optgroup label="M">
            <option value="Macanese">Macanese</option>
            <option value="Macedonian">Macedonian</option>
            <option value="Malagasy">Malagasy</option>
            <option value="Malawian">Malawian</option>
            <option value="Malaysian">Malaysian</option>
            <option value="Maldivian">Maldivian</option>
            <option value="Malian">Malian</option>
            <option value="Maltese">Maltese</option>
            <option value="Marshallese">Marshallese</option>
            <option value="Martiniquais">Martiniquais</option>
            <option value="Mauritanian">Mauritanian</option>
            <option value="Mauritian">Mauritian</option>
            <option value="Mexican">Mexican</option>
            <option value="Micronesian">Micronesian</option>
            <option value="Moldovan">Moldovan</option>
            <option value="Monegasque">Monegasque</option>
            <option value="Mongolian">Mongolian</option>
            <option value="Montenegrin">Montenegrin</option>
            <option value="Montserratian">Montserratian</option>
            <option value="Moroccan">Moroccan</option>
            <option value="Mosotho">Mosotho</option>
            <option value="Mozambican">Mozambican</option>
          </optgroup>
          <optgroup label="N">
            <option value="Namibian">Namibian</option>
            <option value="Nauruan">Nauruan</option>
            <option value="Nepalese">Nepalese</option>
            <option value="New Zealander">New Zealander</option>
            <option value="Nicaraguan">Nicaraguan</option>
            <option value="Nigerian">Nigerian</option>
            <option value="Nigerien">Nigerien</option>
            <option value="Niuean">Niuean</option>
            <option value="North Korean">North Korean</option>
            <option value="Northern Irish">Northern Irish</option>
            <option value="Norwegian">Norwegian</option>
          </optgroup>
        
          <optgroup label="O">
            <option value="Omani">Omani</option>
          </optgroup>
        
          <optgroup label="P">
            <option value="Pakistani">Pakistani</option>
            <option value="Palauan">Palauan</option>
            <option value="Palestinian">Palestinian</option>
            <option value="Panamanian">Panamanian</option>
            <option value="Papua New Guinean">Papua New Guinean</option>
            <option value="Paraguayan">Paraguayan</option>
            <option value="Peruvian">Peruvian</option>
            <option value="Pitcairn Islander">Pitcairn Islander</option>
            <option value="Polish">Polish</option>
            <option value="Portuguese">Portuguese</option>
            <option value="Prydeinig">Prydeinig</option>
            <option value="Puerto Rican">Puerto Rican</option>
          </optgroup>
          <optgroup label="Q">
            <option value="Qatari">Qatari</option>
          </optgroup>
        
          <optgroup label="R">
            <option value="Romanian">Romanian</option>
            <option value="Russian">Russian</option>
            <option value="Rwandan">Rwandan</option>
          </optgroup>
        
          <optgroup label="S">
            <option value="Salvadorean">Salvadorean</option>
            <option value="Sammarinese">Sammarinese</option>
            <option value="Samoan">Samoan</option>
            <option value="Sao Tomean">Sao Tomean</option>
            <option value="Saudi Arabian">Saudi Arabian</option>
            <option value="Scottish">Scottish</option>
            <option value="Senegalese">Senegalese</option>
            <option value="Serbian">Serbian</option>
            <option value="Citizen of Seychelles">Citizen of Seychelles</option>
            <option value="Sierra Leonean">Sierra Leonean</option>
            <option value="Singaporean">Singaporean</option>
            <option value="Slovak">Slovak</option>
            <option value="Slovenian">Slovenian</option>
            <option value="Solomon Islander">Solomon Islander</option>
            <option value="Somali">Somali</option>
            <option value="South African">South African</option>
            <option value="South Korean">South Korean</option>
            <option value="South Sudanese">South Sudanese</option>
            <option value="Spanish">Spanish</option>
            <option value="Sri Lankan">Sri Lankan</option>
            <option value="St Helenian">St Helenian</option>
            <option value="St Lucian">St Lucian</option>
            <option value="Stateless">Stateless</option>
            <option value="Sudanese">Sudanese</option>
            <option value="Surinamese">Surinamese</option>
            <option value="Swazi">Swazi</option>
            <option value="Swedish">Swedish</option>
            <option value="Swiss">Swiss</option>
            <option value="Syrian">Syrian</option>
          </optgroup>
          <optgroup label="T">
            <option value="Taiwanese">Taiwanese</option>
            <option value="Tajik">Tajik</option>
            <option value="Tanzanian">Tanzanian</option>
            <option value="Thai">Thai</option>
            <option value="Togolese">Togolese</option>
            <option value="Tongan">Tongan</option>
            <option value="Trinidadian">Trinidadian</option>
            <option value="Tristanian">Tristanian</option>
            <option value="Tunisian">Tunisian</option>
            <option value="Turkish">Turkish</option>
            <option value="Turkmen">Turkmen</option>
            <option value="Turks and Caicos Islander">Turks and Caicos Islander</option>
            <option value="Tuvaluan">Tuvaluan</option>
          </optgroup>
        
          <optgroup label="U">
            <option value="Ugandan">Ugandan</option>
            <option value="Ukrainian">Ukrainian</option>
            <option value="Uruguayan">Uruguayan</option>
            <option value="Uzbek">Uzbek</option>
          </optgroup>
        
          <optgroup label="V">
            <option value="Vatican citizen">Vatican citizen</option>
            <option value="Citizen of Vanuatu">Citizen of Vanuatu</option>
            <option value="Venezuelan">Venezuelan</option>
            <option value="Vietnamese">Vietnamese</option>
            <option value="Vincentian">Vincentian</option>
          </optgroup>
        
          <optgroup label="W">
            <option value="Wallisian">Wallisian</option>
            <option value="Welsh">Welsh</option>
          </optgroup>
        
          <optgroup label="Y">
            <option value="Yemeni">Yemeni</option>
          </optgroup>
        
          <optgroup label="Z">
            <option value="Zambian">Zambian</option>
            <option value="Zimbabwean">Zimbabwean</option>
          </optgroup>
        </select>

        <label for="disease">Disease</label>
        <select id="disease" name="disease">
          <option value="" disabled selected>Select Disease</option>
        </select>

        <div>
          <label for="height">Height</label>
          <input type="text" id="height" name="height" required placeholder="inches" />
        </div>

        <div>
          <label for="weight">Weight</label>
          <input type="text" id="weight" name="weight" required placeholder="kgs" />
        </div>

        <div>
          <label for="region">Region</label>
          <select id="region" name="region">
            <option value="" disabled selected>Select Current Region</option>
            <option value="Abha">Abha</option>
            <option value="Al Bahah">Al Bahah</option>
            <option value="Sakaka">Sakaka</option>
            <option value="Buraidah">Buraidah</option>
            <option value="Dammam">Dammam</option>
            <option value="Jazan">Jazan</option>
            <option value="Makkah">Makkah</option>
            <option value="Madinah">Madinah</option>
            <option value="Najran">Najran</option>
            <option value="Arar">Arar</option>
            <option value="Riyadh">Riyadh</option>
            <option value="Tabuk">Tabuk</option>
            <option value="Hail">Hail</option>
          </select>
        </div>
        

        <div>
          <label for="medicalHistory">Brief Medical History</label>
          <textarea
            id="medicalHistory"
            name="medicalHistory"
            required
            placeholder="Provide a brief history of medical conditions"
          ></textarea>
        </div>

        <div>
          <label for="familyHistory">Brief Family History</label>
          <textarea
            id="familyHistory"
            name="familyHistory"
            required
            placeholder="e.g., Diabetes, Hypertension, etc."
          ></textarea>
        </div>

        <div>
          <label for="allergies">Allergies</label>
          <textarea
            id="allergies"
            name="allergies"
            required
            placeholder="e.g., Peanuts, Penicillin, Pollen, etc."
          ></textarea>
        </div>

        <div>
          <label for="medicinalHistory">Medicinal History</label>
          <textarea
            id="medicinalHistory"
            name="medicinalHistory"
            required
            placeholder="List medications taken for more than 2 weeks"
          ></textarea>
        </div>

        <div>
          <label for="lifestyle">Lifestyle Information</label>
          <textarea
            id="lifestyle"
            name="lifestyle"
            required
            placeholder="Ex: Smoker, exercise habits, diet, etc."
          ></textarea>
        </div>

        <div>
          <label for="currentExperiencedSymptoms">Current Experienced Symptoms</label>
          <textarea
            id="currentExperiencedSymptoms"
            name="currentExperiencedSymptoms"
            required
            placeholder="e.g. Fatigue, headaches, etc."
          ></textarea>
        </div>
        <label for="id">ID</label>
        <input type="file" id="id" name="id" accept="image/*" />

        <div>
          <label for="emergency-contact">Emergency Contact:</label>
        </div>

        <div>
          <label for="emergency-contact-name">Name</label>
          <input type="text" id="emergency-contact-name" name="emergency-contact-name" required />
        </div>

        <div>
          <label for="emergency-phone">Phone number</label>
          <input type="tel" id="emergency-phone" name="emergency-phone" required placeholder="+966" />
        </div>

        <div>
          <label for="emergency-relation">Relationship</label>
          <input type="text" id="emergency-relation" name="emergency-relation" required placeholder="Ex: Father" />
        </div>
        <div class="checkbox-container">
          <input type="checkbox" id="terms" required />
          <label for="terms">
            I agree to the
            <a href="#" id="terms-link" style="text-decoration: underline">terms and conditions</a>
          </label>
        </div>

        <button type="submit">Sign Up</button>
      </form>
      <div id="terms-modal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h2>Terms and Conditions</h2>
          <div class="terms-text">
            <p>1. Introduction</p>
            <p>
              Welcome to Tadawi, a platform dedicated to matching patients to clinical trials and facilitating
              participation in clinical trials. By accessing or using our Website, you agree to comply with these Terms
              and Conditions. If you do not agree with any part of these Terms, please discontinue your use of the
              Website.
            </p>

            <p>2. Purpose of the Website</p>
            <p>This Website is intended to:</p>
            <ul>
              <li>Provide general information about ongoing and upcoming clinical trials.</li>
              <li>Facilitate participant registration and engagement in clinical research studies.</li>
              <li>Promote awareness of clinical research and its potential benefits.</li>
            </ul>
            <p>
              The information provided on this Website is for informational purposes only and should not be considered
              medical advice.
            </p>

            <p>3. Eligibility</p>
            <p>By using this Website, you confirm that you:</p>
            <ul>
              <li>Are at least 18 years of age or have the consent of a legal guardian.</li>
              <li>Are providing accurate, truthful, and complete information during registration.</li>
              <li>Understand and agree to participate in clinical trials voluntarily, if applicable.</li>
            </ul>

            <p>4. Disclaimer of Medical Advice</p>
            <p>
              The content provided on this Website does not constitute medical advice, diagnosis, or treatment. Always
              consult with your healthcare provider or a qualified medical professional regarding any medical conditions
              or concerns. Participation in any clinical trial should be done under the guidance of a licensed
              physician.
            </p>

            <p>5. Participant Responsibilities</p>
            <p>If you choose to participate in a clinical trial through our Website, you agree to:</p>
            <ul>
              <li>Follow all instructions provided by the clinical trial team.</li>
              <li>Disclose accurate health and medical information during the screening and registration process.</li>
              <li>Inform the clinical trial team of any changes in your health during the trial.</li>
            </ul>

            <p>6. Data Collection and Privacy</p>
            <p>
              We prioritize the confidentiality and security of your personal and medical information. By using our
              Website, you consent to the collection and processing of your data in accordance with our Privacy Policy.
              Key points include:
            </p>
            <ul>
              <li>Personal data will only be used for clinical trial purposes and related communications.</li>
              <li>Data may be shared with authorized clinical trial teams but will not be sold to third parties.</li>
              <li>For more details, refer to our full Privacy Policy.</li>
            </ul>

            <p>7. Intellectual Property</p>
            <p>
              All content, including text, graphics, logos, and design, on this Website is the intellectual property of
              Tadawi. Unauthorized use, reproduction, or distribution of this content is prohibited.
            </p>

            <p>8. Limitation of Liability</p>
            <p>
              To the fullest extent permitted by law, Tadawi and its affiliates are not liable for any damages,
              injuries, or losses arising from:
            </p>
            <ul>
              <li>Participation in clinical trials listed on the Website.</li>
              <li>Errors or inaccuracies in the information provided on the Website.</li>
              <li>Technical failures or interruptions of the Website.</li>
            </ul>

            <p>9. External Links</p>
            <p>
              Our Website may include links to third-party websites. We are not responsible for the content, policies,
              or practices of these websites. Visiting these links is at your own risk.
            </p>

            <p>10. Modification of Terms</p>
            <p>
              We reserve the right to update or modify these Terms and Conditions at any time without prior notice.
              Changes will be effective immediately upon posting to this page. Your continued use of the Website
              constitutes acceptance of the updated Terms.
            </p>

            <p>11. Governing Law</p>
            <p>
              These Terms and Conditions are governed by the laws of Saudi Arabia, without regard to its conflict of law
              provisions. Any disputes arising from these Terms shall be resolved in the courts of Saudi Arabia.
            </p>

            <p>12. Contact Us</p>
            <p>
              If you have any questions, concerns, or feedback regarding these Terms and Conditions, please contact us
              at:
            </p>
            <p>Email: Tadawi.contact@gmail.com</p>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script type="module">
    import { handleFileUpload } from '/js/file-upload.js';
    import { fetchData, postData } from '/js/api.js';

    const termsLink = document.getElementById('terms-link');
    const termsModal = document.getElementById('terms-modal');
    const closeModal = document.querySelector('.close');

    termsLink.addEventListener('click', function (e) {
      e.preventDefault();
      termsModal.style.display = 'flex';
    });

    closeModal.addEventListener('click', function () {
      termsModal.style.display = 'none';
    });

    window.addEventListener('click', function (e) {
      if (e.target === termsModal) {
        termsModal.style.display = 'none';
      }
    });

    //#region Form handling
    document.addEventListener('DOMContentLoaded', init);

    function init() {
      const form = document.getElementById('patientForm');

      // update the dieases list based on api call
      const diseaseSelect = document.getElementById('disease');
      updateDiseases(diseaseSelect);

      // handle submission
      form.addEventListener('submit', async function (e) {
        e.preventDefault();

        // remove previous server error
        form.querySelector('.error[data-server-error]')?.remove();

        const formData = new FormData(form);

        const userDetails = {
          name: formData.get('name'),
          email: formData.get('email'),
          password: formData.get('password'),
          confirmPassword: formData.get('confirmPassword'),
          gender: formData.get('gender'),
          region: formData.get('region'),
          dateOfBirth: formData.get('dateOfBirth'),
          phoneNumber: formData.get('phoneNumber'),
          title: formData.get('title'),
          nationality: formData.get('nationality'),
        };

        const patientDetails = {
          height: formData.get('height'),
          weight: formData.get('weight'),
          allergies: formData.get('allergies'),
          lifestyle: formData.get('lifestyle'),
          emergencyContact: {
            name: formData.get('emergency-contact-name'),
            phoneNumber: formData.get('emergency-phone'),
            relation: formData.get('emergency-relation'),
          },
        };

        const medicalHistory = {
          diseaseId: formData.get('disease'),
          medicalHistory: formData.get('medicalHistory'),
          familyHistory: formData.get('familyHistory'),
          medicinalHistory: formData.get('medicinalHistory'),
          currentExperiencedSymptoms: formData.get('currentExperiencedSymptoms'),
        };

        // TODO: Handle Id file
        const idFile = formData.get('id');
        if (idFile) {
          const uploadIdResponse = await handleFileUpload(idFile);
          if (uploadIdResponse.isOk) {
            patientDetails.idVerification = uploadIdResponse.data;
          }
        }

        // TODO: Form Validation

        const response = await postData('/api/auth/signup', {
          userType: 'patient',
          userDetails,
          patientDetails,
          medicalHistory,
        });

        if (response.isOk) {
          localStorage.setItem('user', JSON.stringify(response.data.user));
          window.location.href = '/SignUp/P-ConfirmSignUp.html';
        } else {
          const errorDiv = document.createElement('div');
          errorDiv.classList.add('error');
          errorDiv.setAttribute('data-server-error', '');
          errorDiv.innerHTML = `${response.message.split('\n').join('<br>')}`;
          form.prepend(errorDiv);
          errorDiv.scrollIntoView({
            behavior: 'smooth',
            block: 'center',
          });
        }
      });
    }

    async function updateDiseases(select) {
      const response = await fetchData('/api/diseases');

      if (response.isOk) {
        const diseasesGroupedByType = response.data;

        for (const diseaseGrp of diseasesGroupedByType) {
          const optGroup = document.createElement('optgroup');
          optGroup.label = diseaseGrp.type;
          select.appendChild(optGroup);

          for (const disease of diseaseGrp.diseases) {
            const option = document.createElement('option');
            option.value = disease.id;
            option.textContent = disease.name;
            optGroup.appendChild(option);
          }
        }
      }
    }
    //#endregion
  </script>
</html>
